!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("angular-gridster2",["exports","@angular/core","@angular/common"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["angular-gridster2"]={},t.ng.core,t.ng.common)}(this,(function(t,e,i){"use strict";var s,r,o,h,n=function(){};(s=t.GridType||(t.GridType={})).Fit="fit",s.ScrollVertical="scrollVertical",s.ScrollHorizontal="scrollHorizontal",s.Fixed="fixed",s.VerticalFixed="verticalFixed",s.HorizontalFixed="horizontalFixed",(r=t.DisplayGrid||(t.DisplayGrid={})).Always="always",r.OnDragAndResize="onDrag&Resize",r.None="none",(o=t.CompactType||(t.CompactType={})).None="none",o.CompactUp="compactUp",o.CompactLeft="compactLeft",o.CompactUpAndLeft="compactUp&Left",o.CompactLeftAndUp="compactLeft&Up",o.CompactRight="compactRight",o.CompactUpAndRight="compactUp&Right",o.CompactRightAndUp="compactRight&Up",(h=t.DirTypes||(t.DirTypes={})).LTR="ltr",h.RTL="rtl";var d=function(){function e(t){this.gridster=t}return e.prototype.destroy=function(){delete this.gridster},e.prototype.checkCompact=function(){this.gridster.$options.compactType!==t.CompactType.None&&(this.gridster.$options.compactType===t.CompactType.CompactUp?this.checkCompactUp():this.gridster.$options.compactType===t.CompactType.CompactLeft?this.checkCompactLeft():this.gridster.$options.compactType===t.CompactType.CompactUpAndLeft?(this.checkCompactUp(),this.checkCompactLeft()):this.gridster.$options.compactType===t.CompactType.CompactLeftAndUp?(this.checkCompactLeft(),this.checkCompactUp()):this.gridster.$options.compactType===t.CompactType.CompactRight?this.checkCompactRight():this.gridster.$options.compactType===t.CompactType.CompactUpAndRight?(this.checkCompactUp(),this.checkCompactRight()):this.gridster.$options.compactType===t.CompactType.CompactRightAndUp&&(this.checkCompactRight(),this.checkCompactUp()))},e.prototype.checkCompactItem=function(e){this.gridster.$options.compactType!==t.CompactType.None&&(this.gridster.$options.compactType===t.CompactType.CompactUp?this.moveUpTillCollision(e):this.gridster.$options.compactType===t.CompactType.CompactLeft?this.moveLeftTillCollision(e):this.gridster.$options.compactType===t.CompactType.CompactUpAndLeft?(this.moveUpTillCollision(e),this.moveLeftTillCollision(e)):this.gridster.$options.compactType===t.CompactType.CompactLeftAndUp?(this.moveLeftTillCollision(e),this.moveUpTillCollision(e)):this.gridster.$options.compactType===t.CompactType.CompactUpAndRight&&(this.moveUpTillCollision(e),this.moveRightTillCollision(e)))},e.prototype.checkCompactUp=function(){for(var t,e=!1,i=this.gridster.grid.length,s=0;s<i;s++)!1!==(t=this.gridster.grid[s]).$item.compactEnabled&&this.moveUpTillCollision(t.$item)&&(e=!0,t.item.y=t.$item.y,t.itemChanged());e&&this.checkCompact()},e.prototype.moveUpTillCollision=function(t){return t.y-=1,this.gridster.checkCollision(t)?(t.y+=1,!1):(this.moveUpTillCollision(t),!0)},e.prototype.checkCompactLeft=function(){for(var t,e=!1,i=this.gridster.grid.length,s=0;s<i;s++)!1!==(t=this.gridster.grid[s]).$item.compactEnabled&&this.moveLeftTillCollision(t.$item)&&(e=!0,t.item.x=t.$item.x,t.itemChanged());e&&this.checkCompact()},e.prototype.checkCompactRight=function(){for(var t,e=!1,i=this.gridster.grid.length,s=0;s<i;s++)!1!==(t=this.gridster.grid[s]).$item.compactEnabled&&this.moveRightTillCollision(t.$item)&&(e=!0,t.item.x=t.$item.x,t.itemChanged());e&&this.checkCompact()},e.prototype.moveLeftTillCollision=function(t){return t.x-=1,this.gridster.checkCollision(t)?(t.x+=1,!1):(this.moveLeftTillCollision(t),!0)},e.prototype.moveRightTillCollision=function(t){return t.x+=1,this.gridster.checkCollision(t)?(t.x-=1,!1):(this.moveRightTillCollision(t),!0)},e}();d.decorators=[{type:e.Injectable}],d.ctorParameters=function(){return[{type:n}]};var l={gridType:t.GridType.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:t.CompactType.None,mobileBreakpoint:640,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:t.DisplayGrid.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,disableAutoPositionOnConflict:!1,dirType:t.DirTypes.LTR},a=function(){function t(){}return t.merge=function(e,i,s){for(var r in i)void 0!==i[r]&&s.hasOwnProperty(r)&&("object"==typeof i[r]?e[r]=t.merge(e[r],i[r],s[r]):e[r]=i[r]);return e},t.debounce=function(t,e){var i;return function(){var s=this,r=arguments,o=function(){i=void 0,t.apply(s,r)};clearTimeout(i),i=setTimeout(o,e)}},t.checkTouchEvent=function(t){void 0===t.clientX&&t.touches&&(t.touches&&t.touches.length?(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY):t.changedTouches&&t.changedTouches.length&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY))},t.checkContentClassForEvent=function(e,i){if(e.$options.draggable.ignoreContent){if(!t.checkDragHandleClass(i.target,i.currentTarget,e.$options.draggable.dragHandleClass,e.$options.draggable.ignoreContentClass))return!0}else if(t.checkContentClass(i.target,i.currentTarget,e.$options.draggable.ignoreContentClass))return!0;return!1},t.checkContentClassForEmptyCellClickEvent=function(e,i){return t.checkContentClass(i.target,i.currentTarget,e.$options.draggable.ignoreContentClass)||t.checkContentClass(i.target,i.currentTarget,e.$options.draggable.dragHandleClass)},t.checkDragHandleClass=function(e,i,s,r){if(!e||e===i)return!1;if(e.hasAttribute("class")){var o=e.getAttribute("class").split(" ");if(o.indexOf(s)>-1)return!0;if(o.indexOf(r)>-1)return!1}return t.checkDragHandleClass(e.parentNode,i,s,r)},t.checkContentClass=function(e,i,s){return!(!e||e===i)&&(!!(e.hasAttribute("class")&&e.getAttribute("class").split(" ").indexOf(s)>-1)||t.checkContentClass(e.parentNode,i,s))},t.compareItems=function(t,e){return t.y>e.y?-1:t.y<e.y?1:t.x>e.x?-1:1},t}();a.decorators=[{type:e.Injectable}];var p=function(){function t(t){this.gridster=t}return t.prototype.destroy=function(){delete this.initialItem,delete this.gridster.movingItem,this.gridster.previewStyle&&this.gridster.previewStyle(),delete this.gridster,this.emptyCellExit&&(this.emptyCellExit(),this.emptyCellExit=null)},t.prototype.updateOptions=function(){var t=this;this.gridster.$options.enableEmptyCellClick&&!this.emptyCellClick&&this.gridster.options.emptyCellClickCallback?(this.emptyCellClick=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb.bind(this)),this.emptyCellClickTouch=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb.bind(this))):!this.gridster.$options.enableEmptyCellClick&&this.emptyCellClick&&this.emptyCellClickTouch&&(this.emptyCellClick(),this.emptyCellClickTouch(),this.emptyCellClick=null,this.emptyCellClickTouch=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.emptyCellContextMenu&&this.gridster.options.emptyCellContextMenuCallback?this.emptyCellContextMenu=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb.bind(this)):!this.gridster.$options.enableEmptyCellContextMenu&&this.emptyCellContextMenu&&(this.emptyCellContextMenu(),this.emptyCellContextMenu=null),this.gridster.$options.enableEmptyCellDrop&&!this.emptyCellDrop&&this.gridster.options.emptyCellDropCallback?(this.emptyCellDrop=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop.bind(this)),this.gridster.zone.runOutsideAngular((function(){t.emptyCellMove=t.gridster.renderer.listen(t.gridster.el,"dragover",t.emptyCellDragOver.bind(t))})),this.emptyCellExit=this.gridster.renderer.listen("document","dragend",(function(){t.gridster.movingItem=null,t.gridster.previewStyle()}))):!this.gridster.$options.enableEmptyCellDrop&&this.emptyCellDrop&&this.emptyCellMove&&this.emptyCellExit&&(this.emptyCellDrop(),this.emptyCellMove(),this.emptyCellExit(),this.emptyCellMove=null,this.emptyCellDrop=null,this.emptyCellExit=null),this.gridster.$options.enableEmptyCellDrag&&!this.emptyCellDrag&&this.gridster.options.emptyCellDragCallback?(this.emptyCellDrag=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown.bind(this)),this.emptyCellDragTouch=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown.bind(this))):!this.gridster.$options.enableEmptyCellDrag&&this.emptyCellDrag&&this.emptyCellDragTouch&&(this.emptyCellDrag(),this.emptyCellDragTouch(),this.emptyCellDrag=null,this.emptyCellDragTouch=null)},t.prototype.emptyCellClickCb=function(t){if(!this.gridster.movingItem&&!a.checkContentClassForEmptyCellClickEvent(this.gridster,t)){var e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,e),this.gridster.cdRef.markForCheck())}},t.prototype.emptyCellContextMenuCb=function(t){if(!this.gridster.movingItem&&!a.checkContentClassForEmptyCellClickEvent(this.gridster,t)){t.preventDefault(),t.stopPropagation();var e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,e),this.gridster.cdRef.markForCheck())}},t.prototype.emptyCellDragDrop=function(t){var e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,e),this.gridster.cdRef.markForCheck())},t.prototype.emptyCellDragOver=function(t){t.preventDefault(),t.stopPropagation();var e=this.getValidItemFromEvent(t);e?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=e):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},t.prototype.emptyCellMouseDown=function(t){var e=this;if(!a.checkContentClassForEmptyCellClickEvent(this.gridster,t)){t.preventDefault(),t.stopPropagation();var i=this.getValidItemFromEvent(t);i&&1===t.buttons&&(this.initialItem=i,this.gridster.movingItem=i,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular((function(){e.emptyCellMMove=e.gridster.renderer.listen("window","mousemove",e.emptyCellMouseMove.bind(e)),e.emptyCellMMoveTouch=e.gridster.renderer.listen("window","touchmove",e.emptyCellMouseMove.bind(e))})),this.emptyCellUp=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp.bind(this)),this.emptyCellUpTouch=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp.bind(this)))}},t.prototype.emptyCellMouseMove=function(t){t.preventDefault(),t.stopPropagation();var e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e,this.gridster.previewStyle())},t.prototype.emptyCellMouseUp=function(t){var e=this;this.emptyCellMMove(),this.emptyCellMMoveTouch(),this.emptyCellUp(),this.emptyCellUpTouch();var i=this.getValidItemFromEvent(t,this.initialItem);i&&(this.gridster.movingItem=i),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout((function(){e.initialItem=null,e.gridster&&(e.gridster.movingItem=null,e.gridster.previewStyle())})),this.gridster.cdRef.markForCheck()},t.prototype.getPixelsX=function(t,e){var i=this.gridster.options.scale;return i?(t.clientX-e.left)/i+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():t.clientX+this.gridster.el.scrollLeft-e.left-this.gridster.gridRenderer.getLeftMargin()},t.prototype.getPixelsY=function(t,e){var i=this.gridster.options.scale;return i?(t.clientY-e.top)/i+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():t.clientY+this.gridster.el.scrollTop-e.top-this.gridster.gridRenderer.getTopMargin()},t.prototype.getValidItemFromEvent=function(t,e){t.preventDefault(),t.stopPropagation(),a.checkTouchEvent(t);var i=this.gridster.el.getBoundingClientRect(),s=this.getPixelsX(t,i),r=this.getPixelsY(t,i),o={x:this.gridster.pixelsToPositionX(s,Math.floor,!0),y:this.gridster.pixelsToPositionY(r,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(e&&(o.cols=Math.min(Math.abs(e.x-o.x)+1,this.gridster.$options.emptyCellDragMaxCols),o.rows=Math.min(Math.abs(e.y-o.y)+1,this.gridster.$options.emptyCellDragMaxRows),e.x<o.x?o.x=e.x:e.x-o.x>this.gridster.$options.emptyCellDragMaxCols-1&&(o.x=this.gridster.movingItem?this.gridster.movingItem.x:0),e.y<o.y?o.y=e.y:e.y-o.y>this.gridster.$options.emptyCellDragMaxRows-1&&(o.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),this.gridster.$options.enableOccupiedCellDrop||!this.gridster.checkCollision(o))return o},t}();p.decorators=[{type:e.Injectable}],p.ctorParameters=function(){return[{type:n}]};var m=function(){function e(t){this.gridster=t}return e.prototype.destroy=function(){delete this.gridster},e.prototype.updateItem=function(e,i,s){if(this.gridster.mobile)this.clearCellPosition(s,e),this.gridster.$options.keepFixedHeightInMobile?s.setStyle(e,"height",i.rows*this.gridster.$options.fixedRowHeight+"px"):s.setStyle(e,"height",i.rows*this.gridster.curWidth/i.cols+"px"),this.gridster.$options.keepFixedWidthInMobile?s.setStyle(e,"width",this.gridster.$options.fixedColWidth+"px"):s.setStyle(e,"width",""),s.setStyle(e,"margin-bottom",this.gridster.$options.margin+"px"),s.setStyle(e,t.DirTypes.LTR?"margin-right":"margin-left","");else{var r=Math.round(this.gridster.curColWidth*i.x),o=Math.round(this.gridster.curRowHeight*i.y),h=this.gridster.curColWidth*i.cols-this.gridster.$options.margin,n=this.gridster.curRowHeight*i.rows-this.gridster.$options.margin;this.setCellPosition(s,e,r,o),s.setStyle(e,"width",h+"px"),s.setStyle(e,"height",n+"px");var d=null,l=null;this.gridster.$options.outerMargin&&(this.gridster.rows===i.rows+i.y&&(d=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginBottom+"px":this.gridster.$options.margin+"px"),this.gridster.columns===i.cols+i.x&&(l=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginRight+"px":this.gridster.$options.margin+"px")),s.setStyle(e,"margin-bottom",d),s.setStyle(e,t.DirTypes.LTR?"margin-right":"margin-left",l)}},e.prototype.updateGridster=function(){var e="",i="",s="",r="";this.gridster.$options.gridType===t.GridType.Fit?(e=t.GridType.Fit,i=t.GridType.ScrollVertical,s=t.GridType.ScrollHorizontal,r=t.GridType.Fixed):this.gridster.$options.gridType===t.GridType.ScrollVertical?(this.gridster.curRowHeight=this.gridster.curColWidth,e=t.GridType.ScrollVertical,i=t.GridType.Fit,s=t.GridType.ScrollHorizontal,r=t.GridType.Fixed):this.gridster.$options.gridType===t.GridType.ScrollHorizontal?(this.gridster.curColWidth=this.gridster.curRowHeight,e=t.GridType.ScrollHorizontal,i=t.GridType.Fit,s=t.GridType.ScrollVertical,r=t.GridType.Fixed):this.gridster.$options.gridType===t.GridType.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=t.GridType.Fixed,i=t.GridType.Fit,s=t.GridType.ScrollVertical,r=t.GridType.ScrollHorizontal):this.gridster.$options.gridType===t.GridType.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=t.GridType.ScrollVertical,i=t.GridType.Fit,s=t.GridType.ScrollHorizontal,r=t.GridType.Fixed):this.gridster.$options.gridType===t.GridType.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=t.GridType.ScrollHorizontal,i=t.GridType.Fit,s=t.GridType.ScrollVertical,r=t.GridType.Fixed),this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==t.GridType.Fit?this.gridster.renderer.removeClass(this.gridster.el,e):this.gridster.renderer.addClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,i),this.gridster.renderer.removeClass(this.gridster.el,s),this.gridster.renderer.removeClass(this.gridster.el,r)},e.prototype.getGridColumnStyle=function(t){return Object.assign(Object.assign({},this.getLeftPosition(this.gridster.curColWidth*t)),{width:this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin+"px"})},e.prototype.getGridRowStyle=function(t){return Object.assign(Object.assign({},this.getTopPosition(this.gridster.curRowHeight*t)),{width:this.gridster.gridColumns.length*this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.curRowHeight-this.gridster.$options.margin+"px"})},e.prototype.getLeftPosition=function(e){var i=this.gridster.$options.dirType===t.DirTypes.RTL?-e:e;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+i+"px)"}:{left:this.getLeftMargin()+i+"px"}},e.prototype.getTopPosition=function(t){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+t+"px)"}:{top:this.getTopMargin()+t+"px"}},e.prototype.clearCellPosition=function(t,e){this.gridster.$options.useTransformPositioning?t.setStyle(e,"transform",""):(t.setStyle(e,"top",""),t.setStyle(e,"left",""))},e.prototype.setCellPosition=function(e,i,s,r){var o=this.gridster.$options.dirType===t.DirTypes.RTL?-s:s;if(this.gridster.$options.useTransformPositioning){var h="translate3d("+o+"px, "+r+"px, 0)";e.setStyle(i,"transform",h)}else e.setStyle(i,"left",this.getLeftMargin()+o+"px"),e.setStyle(i,"top",this.getTopMargin()+r+"px")},e.prototype.getLeftMargin=function(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginLeft?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0},e.prototype.getTopMargin=function(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginTop?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0},e}();m.decorators=[{type:e.Injectable}],m.ctorParameters=function(){return[{type:n}]};var g=function(){function e(t,e,i,s){this.renderer=e,this.cdRef=i,this.zone=s,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.el=t.nativeElement,this.$options=JSON.parse(JSON.stringify(l)),this.calculateLayoutDebounce=a.debounce(this.calculateLayout.bind(this),0),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new p(this),this.compact=new d(this),this.gridRenderer=new m(this)}return e.checkCollisionTwoItemsForSwaping=function(t,e){var i=1===t.cols?0:1,s=1===e.cols?0:1,r=1===t.rows?0:1,o=1===e.rows?0:1;return t.x+i<e.x+e.cols&&t.x+t.cols>e.x+s&&t.y+r<e.y+e.rows&&t.y+t.rows>e.y+o},e.prototype.checkCollisionTwoItems=function(t,e){if(!(t.x<e.x+e.cols&&t.x+t.cols>e.x&&t.y<e.y+e.rows&&t.y+t.rows>e.y))return!1;if(!this.$options.allowMultiLayer)return!0;var i=this.$options.defaultLayerIndex;return(void 0===t.layerIndex?i:t.layerIndex)===(void 0===e.layerIndex?i:e.layerIndex)},e.prototype.ngOnInit=function(){this.options.initCallback&&this.options.initCallback(this)},e.prototype.ngOnChanges=function(t){var e=this;t.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged.bind(this),resize:this.onResize.bind(this),getNextPossiblePosition:this.getNextPossiblePosition.bind(this),getFirstPossiblePosition:this.getFirstPossiblePosition.bind(this),getLastPossiblePosition:this.getLastPossiblePosition.bind(this),getItemComponent:function(t){return e.getItemComponent(t)}},this.columns=this.$options.minCols,this.rows=this.$options.minRows,this.setGridSize(),this.calculateLayout())},e.prototype.resize=function(){var t,e;"fit"!==this.$options.gridType||this.mobile?(e=this.el.clientWidth,t=this.el.clientHeight):(e=this.el.offsetWidth,t=this.el.offsetHeight),e===this.curWidth&&t===this.curHeight||!this.checkIfToResize()||this.onResize()},e.prototype.setOptions=function(){this.$options=a.merge(this.$options,this.options,this.$options),this.$options.disableWindowResize||this.windowResize?this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null):this.windowResize=this.renderer.listen("window","resize",this.onResize.bind(this)),this.emptyCell.updateOptions()},e.prototype.optionsChanged=function(){this.setOptions();for(var t=this.grid.length-1;t>=0;t--)this.grid[t].updateOptions();this.calculateLayout()},e.prototype.ngOnDestroy=function(){this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),delete this.emptyCell,this.compact.destroy(),delete this.compact},e.prototype.onResize=function(){this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout()},e.prototype.checkIfToResize=function(){var t=this.el.clientWidth,e=this.el.offsetWidth,i=this.el.scrollWidth,s=this.el.clientHeight,r=this.el.offsetHeight,o=this.el.scrollHeight;return!(t<e&&o>r&&o-r<e-t)&&!(s<r&&i>e&&i-e<r-s)},e.prototype.setGridSize=function(){var e,i,s=this.el;this.$options.setGridSize||this.$options.gridType===t.GridType.Fit&&!this.mobile?(e=s.offsetWidth,i=s.offsetHeight):(e=s.clientWidth,i=s.clientHeight),this.curWidth=e,this.curHeight=i},e.prototype.setGridDimensions=function(){this.setGridSize(),!this.mobile&&this.$options.mobileBreakpoint>this.curWidth?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&this.$options.mobileBreakpoint<this.curWidth&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));for(var t,e=this.$options.minRows,i=this.$options.minCols,s=this.grid.length-1;s>=0;s--)(t=this.grid[s]).notPlaced||(e=Math.max(e,t.$item.y+t.$item.rows),i=Math.max(i,t.$item.x+t.$item.cols));this.columns===i&&this.rows===e||(this.columns=i,this.rows=e,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))},e.prototype.calculateLayout=function(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){var t=-this.$options.margin;null!==this.$options.outerMarginLeft?(t+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(t+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),null!==this.$options.outerMarginRight?(t+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(t+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-t)/this.columns;var e=-this.$options.margin;null!==this.$options.outerMarginTop?(e+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(e+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),null!==this.$options.outerMarginBottom?(e+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(e+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-e)/this.rows}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();for(var i,s=this.grid.length-1;s>=0;s--)(i=this.grid[s]).setSize(),i.drag.toggle(),i.resize.toggle();setTimeout(this.resize.bind(this),100)},e.prototype.updateGrid=function(){"always"!==this.$options.displayGrid||this.mobile?"onDrag&Resize"===this.$options.displayGrid&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):"none"!==this.$options.displayGrid&&this.dragInProgress&&!this.mobile||this.renderer.removeClass(this.el,"display-grid"):this.renderer.addClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=e.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=e.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()},e.prototype.addItem=function(t){void 0===t.$item.cols&&(t.$item.cols=this.$options.defaultItemCols,t.item.cols=t.$item.cols,t.itemChanged()),void 0===t.$item.rows&&(t.$item.rows=this.$options.defaultItemRows,t.item.rows=t.$item.rows,t.itemChanged()),-1===t.$item.x||-1===t.$item.y?this.autoPositionItem(t):this.checkCollision(t.$item)&&(this.$options.disableWarnings||(t.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(t.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?t.notPlaced=!0:this.autoPositionItem(t)),this.grid.push(t),this.calculateLayoutDebounce()},e.prototype.removeItem=function(t){this.grid.splice(this.grid.indexOf(t),1),this.calculateLayoutDebounce(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(t.item,t)},e.prototype.checkCollision=function(t){var e=!1;if(this.options.itemValidateCallback&&(e=!this.options.itemValidateCallback(t)),!e&&this.checkGridCollision(t)&&(e=!0),!e){var i=this.findItemWithItem(t);i&&(e=i)}return e},e.prototype.checkGridCollision=function(t){var e=t.y>-1&&t.x>-1,i=t.cols+t.x<=this.$options.maxCols,s=t.rows+t.y<=this.$options.maxRows,r=void 0===t.maxItemCols?this.$options.maxItemCols:t.maxItemCols,o=void 0===t.minItemCols?this.$options.minItemCols:t.minItemCols,h=void 0===t.maxItemRows?this.$options.maxItemRows:t.maxItemRows,n=void 0===t.minItemRows?this.$options.minItemRows:t.minItemRows,d=t.cols<=r&&t.cols>=o,l=t.rows<=h&&t.rows>=n,a=void 0===t.minItemArea?this.$options.minItemArea:t.minItemArea,p=void 0===t.maxItemArea?this.$options.maxItemArea:t.maxItemArea,m=t.cols*t.rows;return!(e&&i&&s&&d&&l&&a<=m&&p>=m)},e.prototype.findItemWithItem=function(t){for(var e,i=0;i<this.grid.length;i++)if((e=this.grid[i]).$item!==t&&this.checkCollisionTwoItems(e.$item,t))return e;return!1},e.prototype.findItemsWithItem=function(t){for(var e,i=[],s=0;s<this.grid.length;s++)(e=this.grid[s]).$item!==t&&this.checkCollisionTwoItems(e.$item,t)&&i.push(e);return i},e.prototype.autoPositionItem=function(t){this.getNextPossiblePosition(t.$item)?(t.notPlaced=!1,t.item.x=t.$item.x,t.item.y=t.$item.y,t.itemChanged()):(t.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(t.item,["cols","rows","x","y"])))},e.prototype.getNextPossiblePosition=function(t,e){void 0===e&&(e={}),-1===t.cols&&(t.cols=this.$options.defaultItemCols),-1===t.rows&&(t.rows=this.$options.defaultItemRows),this.setGridDimensions();for(var i,s=e.y||0;s<this.rows;s++)for(t.y=s,i=e.x||0;i<this.columns;i++)if(t.x=i,!this.checkCollision(t))return!0;var r=this.$options.maxRows>=this.rows+t.rows,o=this.$options.maxCols>=this.columns+t.cols;return!(this.rows<=this.columns&&r)&&o?(t.x=this.columns,t.y=0,!0):!!r&&(t.y=this.rows,t.x=0,!0)},e.prototype.getFirstPossiblePosition=function(t){var e=Object.assign({},t);return this.getNextPossiblePosition(e),e},e.prototype.getLastPossiblePosition=function(t){var e={y:0,x:0};e=this.grid.reduce((function(t,e){var i={y:e.$item.y+e.$item.rows-1,x:e.$item.x+e.$item.cols-1};return 1===a.compareItems(t,i)?i:t}),e);var i=Object.assign({},t);return this.getNextPossiblePosition(i,e),i},e.prototype.pixelsToPositionX=function(t,e,i){var s=e(t/this.curColWidth);return i?s:Math.max(s,0)},e.prototype.pixelsToPositionY=function(t,e,i){var s=e(t/this.curRowHeight);return i?s:Math.max(s,0)},e.prototype.positionXToPixels=function(t){return t*this.curColWidth},e.prototype.positionYToPixels=function(t){return t*this.curRowHeight},e.prototype.getItemComponent=function(t){return this.grid.find((function(e){return e.item===t}))},e.prototype.checkCollisionForSwaping=function(t){var e=!1;if(this.options.itemValidateCallback&&(e=!this.options.itemValidateCallback(t)),!e&&this.checkGridCollision(t)&&(e=!0),!e){var i=this.findItemWithItemForSwaping(t);i&&(e=i)}return e},e.prototype.findItemWithItemForSwaping=function(t){for(var i,s=this.grid.length-1;s>-1;s--)if((i=this.grid[s]).$item!==t&&e.checkCollisionTwoItemsForSwaping(i.$item,t))return i;return!1},e.getNewArrayLength=function(t,e,i){var s=Math.max(t,Math.floor(e/i));return s<0?0:Number.isFinite(s)?Math.floor(s):0},e}();g.decorators=[{type:e.Component,args:[{selector:"gridster",template:'<div class="gridster-column" *ngFor="let column of gridColumns; let i = index;"\n     [ngStyle]="gridRenderer.getGridColumnStyle(i)"></div>\n<div class="gridster-row" *ngFor="let row of gridRows; let i = index;"\n     [ngStyle]="gridRenderer.getGridRowStyle(i)"></div>\n<ng-content></ng-content>\n<gridster-preview class="gridster-preview"></gridster-preview>\n',encapsulation:e.ViewEncapsulation.None,styles:["gridster{-ms-user-select:none;-webkit-user-select:none;background:grey;box-sizing:border-box;display:block;height:100%;position:relative;user-select:none;width:100%}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:auto;width:auto}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{box-sizing:border-box;display:none;position:absolute;transition:.3s}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid #fff;border-right:1px solid #fff}gridster .gridster-row{border-bottom:1px solid #fff;border-top:1px solid #fff}"]}]}],g.ctorParameters=function(){return[{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:e.Renderer2,decorators:[{type:e.Inject,args:[e.Renderer2]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:e.NgZone,decorators:[{type:e.Inject,args:[e.NgZone]}]}]},g.propDecorators={options:[{type:e.Input}]};var c,u,y=function(){},f=function(){function t(t){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}return t.prototype.destroy=function(){delete this.gridster,delete this.gridsterItem},t.prototype.pushItems=function(t,e){if(this.gridster.$options.pushItems&&!e){this.pushedItemsOrder=[],this.iteration=0;var i=this.push(this.gridsterItem,t);return i||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],i}return!1},t.prototype.restoreTempItems=function(){for(var t=this.pushedItemsTemp.length-1;t>-1;t--)this.removeFromTempPushed(this.pushedItemsTemp[t])},t.prototype.restoreItems=function(){for(var t,e=0,i=this.pushedItems.length;e<i;e++)(t=this.pushedItems[e]).$item.x=t.item.x||0,t.$item.y=t.item.y||0,t.setSize();this.pushedItems=[],this.pushedItemsPath=[]},t.prototype.setPushedItems=function(){for(var t,e=0,i=this.pushedItems.length;e<i;e++)(t=this.pushedItems[e]).checkItemChanges(t.$item,t.item);this.pushedItems=[],this.pushedItemsPath=[]},t.prototype.checkPushBack=function(){for(var t=this.pushedItems.length-1,e=!1;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()},t.prototype.push=function(t,e){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(t.$item))return!1;if(""===e)return!1;var i=this.gridster.findItemsWithItem(t.$item),s=e===this.fromNorth||e===this.fromWest;i.sort((function(t,e){return s?e.$item.y-t.$item.y||e.$item.x-t.$item.x:t.$item.y-e.$item.y||t.$item.x-e.$item.x}));for(var r,o=0,h=!0,n=[];o<i.length;o++)if((r=i[o])!==this.gridsterItem){if(!r.canBeDragged()){h=!1;break}var d=this.pushedItemsTemp.indexOf(r);if(d>-1&&this.pushedItemsTempPath[d].length>10){h=!1;break}if(this.tryPattern[e][0].call(this,r,t))this.pushedItemsOrder.push(r),n.push(r);else if(this.tryPattern[e][1].call(this,r,t))this.pushedItemsOrder.push(r),n.push(r);else if(this.tryPattern[e][2].call(this,r,t))this.pushedItemsOrder.push(r),n.push(r);else{if(!this.tryPattern[e][3].call(this,r,t)){h=!1;break}this.pushedItemsOrder.push(r),n.push(r)}}if(!h&&(o=this.pushedItemsOrder.lastIndexOf(n[0]))>-1)for(var l=this.pushedItemsOrder.length-1;l>=o;l--)r=this.pushedItemsOrder[l],this.pushedItemsOrder.pop(),this.removeFromTempPushed(r),this.removeFromPushedItem(r);return this.iteration++,h},t.prototype.trySouth=function(t,e){return!!this.gridster.$options.pushDirections.south&&(this.addToTempPushed(t),t.$item.y=e.$item.y+e.$item.rows,this.push(t,this.fromNorth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1))},t.prototype.tryNorth=function(t,e){return!!this.gridster.$options.pushDirections.north&&(this.addToTempPushed(t),t.$item.y=e.$item.y-t.$item.rows,this.push(t,this.fromSouth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1))},t.prototype.tryEast=function(t,e){return!!this.gridster.$options.pushDirections.east&&(this.addToTempPushed(t),t.$item.x=e.$item.x+e.$item.cols,this.push(t,this.fromWest)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1))},t.prototype.tryWest=function(t,e){return!!this.gridster.$options.pushDirections.west&&(this.addToTempPushed(t),t.$item.x=e.$item.x-t.$item.cols,this.push(t,this.fromEast)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1))},t.prototype.addToTempPushed=function(t){var e=this.pushedItemsTemp.indexOf(t);-1===e&&(e=this.pushedItemsTemp.push(t)-1,this.pushedItemsTempPath[e]=[]),this.pushedItemsTempPath[e].push({x:t.$item.x,y:t.$item.y})},t.prototype.removeFromTempPushed=function(t){var e=this.pushedItemsTemp.indexOf(t),i=this.pushedItemsTempPath[e].pop();i&&(t.$item.x=i.x,t.$item.y=i.y,t.setSize(),this.pushedItemsTempPath[e].length||(this.pushedItemsTemp.splice(e,1),this.pushedItemsTempPath.splice(e,1)))},t.prototype.addToPushed=function(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0},{x:t.$item.x,y:t.$item.y}]);else{var e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y})}},t.prototype.removeFromPushed=function(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))},t.prototype.removeFromPushedItem=function(t){var e=this.pushedItems.indexOf(t);e>-1&&(this.pushedItemsPath[e].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1)))},t.prototype.checkPushedItem=function(t,e){for(var i,s,r,o=this.pushedItemsPath[e],h=o.length-2,n=!1;h>-1;h--)i=o[h],s=t.$item.x,r=t.$item.y,t.$item.x=i.x,t.$item.y=i.y,this.gridster.findItemWithItem(t.$item)?(t.$item.x=s,t.$item.y=r):(t.setSize(),o.splice(h+1,o.length-h-1),n=!0);return o.length<2&&this.removeFromPushed(e),n},t}();f.decorators=[{type:e.Injectable}],f.ctorParameters=function(){return[{type:y}]};var I,C,$,v,w,x,b;function T(t,e,i,s,r,o,h,n,d,l){c=t.$options.scrollSensitivity,u=t.$options.scrollSpeed,I=t.el,C=d,$=l;var a=I.offsetWidth,p=I.offsetHeight,m=I.scrollLeft,g=I.scrollTop,y=i-g,f=p+g-i-r;if(!t.$options.disableScrollVertical)if(h.clientY<o.clientY&&f<c){if(L(),C&&$&&!$.s||b)return;b=S(1,n,h)}else if(h.clientY>o.clientY&&g>0&&y<c){if(E(),C&&$&&!$.n||x)return;x=S(-1,n,h)}else h.clientY!==o.clientY&&R();var T=m+a-e-s,z=e-m;if(!t.$options.disableScrollHorizontal)if(h.clientX<o.clientX&&T<=c){if(D(),C&&$&&!$.e||v)return;v=k(1,n,h)}else if(h.clientX>o.clientX&&m>0&&z<c){if(M(),C&&$&&!$.w||w)return;w=k(-1,n,h)}else h.clientX!==o.clientX&&P()}function S(t,e,i){var s=i.clientY;return setInterval((function(){(!I||-1===t&&I.scrollTop-u<0)&&R(),I.scrollTop+=t*u,s+=t*u,e({clientX:i.clientX,clientY:s})}),50)}function k(t,e,i){var s=i.clientX;return setInterval((function(){(!I||-1===t&&I.scrollLeft-u<0)&&P(),I.scrollLeft+=t*u,e({clientX:s+=t*u,clientY:i.clientY})}),50)}function z(){P(),R(),I=null}function P(){M(),D()}function R(){L(),E()}function M(){v&&(clearInterval(v),v=0)}function D(){w&&(clearInterval(w),w=0)}function E(){b&&(clearInterval(b),b=0)}function L(){x&&(clearInterval(x),x=0)}var F=function(){function t(t){this.gridsterItem=t,this.gridster=t.gridster}return t.prototype.destroy=function(){delete this.gridster,delete this.gridsterItem,delete this.swapedItem},t.prototype.swapItems=function(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))},t.prototype.checkSwapBack=function(){if(this.swapedItem){var t=this.swapedItem.$item.x,e=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=t,this.swapedItem.$item.y=e):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}},t.prototype.restoreSwapItem=function(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)},t.prototype.setSwapItem=function(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)},t.prototype.checkSwap=function(t){var e;if((e=this.gridster.$options.swapWhileDragging?this.gridster.checkCollisionForSwaping(t.$item):this.gridster.checkCollision(t.$item))&&!0!==e&&e.canBeDragged()){var i=e,s=i.$item.x,r=i.$item.y,o=t.$item.x,h=t.$item.y;i.$item.x=t.item.x||0,i.$item.y=t.item.y||0,t.$item.x=i.item.x||0,t.$item.y=i.item.y||0,this.gridster.checkCollision(i.$item)||this.gridster.checkCollision(t.$item)?(t.$item.x=o,t.$item.y=h,i.$item.x=s,i.$item.y=r):(i.setSize(),this.swapedItem=i,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}},t}();F.decorators=[{type:e.Injectable}],F.ctorParameters=function(){return[{type:y}]};var W=function(){function e(t,e,i){this.zone=i,this.collision=!1,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.path=[]}return e.prototype.destroy=function(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),delete this.gridsterItem,delete this.gridster,delete this.collision,this.mousedown&&(this.mousedown(),this.touchstart())},e.prototype.dragStart=function(e){var i=this;e.which&&1!==e.which||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.dragFunction=this.dragMove.bind(this),this.dragStopFunction=this.dragStop.bind(this),this.zone.runOutsideAngular((function(){i.mousemove=i.gridsterItem.renderer.listen("document","mousemove",i.dragFunction),i.touchmove=i.gridster.renderer.listen(i.gridster.el,"touchmove",i.dragFunction)})),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStopFunction),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStopFunction),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStopFunction),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStopFunction),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStopFunction),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.gridster.$options.dirType===t.DirTypes.RTL?this.diffLeft=e.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:this.diffLeft=e.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=e.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new f(this.gridsterItem),this.swap=new F(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))},e.prototype.dragMove=function(t){t.stopPropagation(),t.preventDefault(),a.checkTouchEvent(t),this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,T(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.calculateItemPositionFromMousePosition.bind(this)),this.calculateItemPositionFromMousePosition(t)},e.prototype.calculateItemPositionFromMousePosition=function(t){var e=this;this.gridster.options.scale?this.calculateItemPositionWithScale(t,this.gridster.options.scale):this.calculateItemPositionWithoutScale(t),this.calculateItemPosition(),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run((function(){e.gridster.updateGrid()}))},e.prototype.calculateItemPositionWithScale=function(e,i){this.gridster.$options.dirType===t.DirTypes.RTL?this.left=this.gridster.el.scrollWidth-this.originalClientX+(e.clientX-this.originalClientX)/i+this.diffLeft:this.left=this.originalClientX+(e.clientX-this.originalClientX)/i+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(e.clientY-this.originalClientY)/i+this.offsetTop-this.diffTop},e.prototype.calculateItemPositionWithoutScale=function(e){this.gridster.$options.dirType===t.DirTypes.RTL?this.left=this.gridster.el.scrollWidth-e.clientX+this.diffLeft:this.left=e.clientX+this.offsetLeft-this.diffLeft,this.top=e.clientY+this.offsetTop-this.diffTop},e.prototype.dragStop=function(t){var e=this;t.stopPropagation(),t.preventDefault(),z(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeDrag.bind(this),this.cancelDrag.bind(this)):this.makeDrag(),setTimeout((function(){e.gridster&&(e.gridster.movingItem=null,e.gridster.previewStyle(!0))}))},e.prototype.cancelDrag=function(){this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),delete this.push),this.swap&&(this.swap.destroy(),delete this.swap)},e.prototype.makeDrag=function(){this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&!0!==this.collision&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),delete this.push),this.swap&&(this.swap.destroy(),delete this.swap)},e.prototype.calculateItemPosition=function(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){var t=this.path[this.path.length-1],e="";t.x<this.gridsterItem.$item.x?e=this.push.fromWest:t.x>this.gridsterItem.$item.x?e=this.push.fromEast:t.y<this.gridsterItem.$item.y?e=this.push.fromNorth:t.y>this.gridsterItem.$item.y&&(e=this.push.fromSouth),this.push.pushItems(e,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&!0!==this.collision&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}this.gridster.previewStyle(!0)},e.prototype.toggle=function(){var t=this.gridsterItem.canBeDragged();!this.enabled&&t?(this.enabled=!this.enabled,this.dragStartFunction=this.dragStartDelay.bind(this),this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartFunction),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartFunction)):this.enabled&&!t&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())},e.prototype.dragStartDelay=function(t){var e=this;if(!(t.target.hasAttribute("class")&&t.target.getAttribute("class").split(" ").indexOf("gridster-item-resizable-handler")>-1||a.checkContentClassForEvent(this.gridster,t)))if(a.checkTouchEvent(t),this.gridster.$options.draggable.delayStart)var i=setTimeout((function(){e.dragStart(t),l()}),this.gridster.$options.draggable.delayStart),s=this.gridsterItem.renderer.listen("document","mouseup",l),r=this.gridsterItem.renderer.listen("document","mouseleave",l),o=this.gridsterItem.renderer.listen("window","blur",l),h=this.gridsterItem.renderer.listen("document","touchmove",(function(e){a.checkTouchEvent(e),(Math.abs(e.clientX-t.clientX)>9||Math.abs(e.clientY-t.clientY)>9)&&l()})),n=this.gridsterItem.renderer.listen("document","touchend",l),d=this.gridsterItem.renderer.listen("document","touchcancel",l);else this.dragStart(t);function l(){clearTimeout(i),o(),s(),r(),h(),n(),d()}},e}();W.decorators=[{type:e.Injectable}],W.ctorParameters=function(){return[{type:y},{type:n},{type:e.NgZone}]};var O=function(){function t(t){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}return t.prototype.destroy=function(){delete this.gridster,delete this.gridsterItem},t.prototype.pushItems=function(t){return!!this.gridster.$options.pushResizeItems&&this.push(this.gridsterItem,t)},t.prototype.restoreItems=function(){for(var t,e=0,i=this.pushedItems.length;e<i;e++)(t=this.pushedItems[e]).$item.x=t.item.x||0,t.$item.y=t.item.y||0,t.$item.cols=t.item.cols||1,t.$item.row=t.item.row||1,t.setSize();this.pushedItems=[],this.pushedItemsPath=[]},t.prototype.setPushedItems=function(){for(var t,e=0,i=this.pushedItems.length;e<i;e++)(t=this.pushedItems[e]).checkItemChanges(t.$item,t.item);this.pushedItems=[],this.pushedItemsPath=[]},t.prototype.checkPushBack=function(){for(var t=this.pushedItems.length-1,e=!1;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()},t.prototype.push=function(t,e){var i=this.gridster.checkCollision(t.$item);if(i&&!0!==i&&i!==this.gridsterItem&&i.canBeResized()){if(this.tryPattern[e].call(this,i,t,e))return!0}else if(!1===i)return!0;return!1},t.prototype.trySouth=function(t,e,i){var s=t.$item.y,r=t.$item.rows;return t.$item.y=e.$item.y+e.$item.rows,t.$item.rows=r+s-t.$item.y,this.gridster.checkCollisionTwoItems(t.$item,e.$item)||this.gridster.checkGridCollision(t.$item)?(t.$item.y=s,t.$item.rows=r,!1):(t.setSize(),this.addToPushed(t),this.push(e,i),!0)},t.prototype.tryNorth=function(t,e,i){var s=t.$item.rows;return t.$item.rows=e.$item.y-t.$item.y,this.gridster.checkCollisionTwoItems(t.$item,e.$item)||this.gridster.checkGridCollision(t.$item)?(t.$item.rows=s,!1):(t.setSize(),this.addToPushed(t),this.push(e,i),!0)},t.prototype.tryEast=function(t,e,i){var s=t.$item.x,r=t.$item.cols;return t.$item.x=e.$item.x+e.$item.cols,t.$item.cols=r+s-t.$item.x,this.gridster.checkCollisionTwoItems(t.$item,e.$item)||this.gridster.checkGridCollision(t.$item)?(t.$item.x=s,t.$item.cols=r,!1):(t.setSize(),this.addToPushed(t),this.push(e,i),!0)},t.prototype.tryWest=function(t,e,i){var s=t.$item.cols;return t.$item.cols=e.$item.x-t.$item.x,this.gridster.checkCollisionTwoItems(t.$item,e.$item)||this.gridster.checkGridCollision(t.$item)?(t.$item.cols=s,!1):(t.setSize(),this.addToPushed(t),this.push(e,i),!0)},t.prototype.addToPushed=function(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0,cols:t.item.cols||0,rows:t.item.rows||0},{x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows}]);else{var e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows})}},t.prototype.removeFromPushed=function(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))},t.prototype.checkPushedItem=function(t,e){for(var i,s,r,o,h,n=this.pushedItemsPath[e],d=n.length-2;d>-1;d--)i=n[d],s=t.$item.x,r=t.$item.y,o=t.$item.cols,h=t.$item.rows,t.$item.x=i.x,t.$item.y=i.y,t.$item.cols=i.cols,t.$item.rows=i.rows,this.gridster.findItemWithItem(t.$item)?(t.$item.x=s,t.$item.y=r,t.$item.cols=o,t.$item.rows=h):(t.setSize(),n.splice(d+1,n.length-1-d));return n.length<2&&(this.removeFromPushed(e),!0)},t}();O.decorators=[{type:e.Injectable}],O.ctorParameters=function(){return[{type:y}]};var G=function(){function e(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={w:!1,e:!1,n:!1,s:!1}}return e.prototype.destroy=function(){this.gridster.previewStyle&&this.gridster.previewStyle(),delete this.gridsterItem,delete this.gridster},e.prototype.dragStart=function(e){var i,s,r,o=this;e.which&&1!==e.which||(this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.dragFunction=this.dragMove.bind(this),this.dragStopFunction=this.dragStop.bind(this),this.zone.runOutsideAngular((function(){o.mousemove=o.gridsterItem.renderer.listen("document","mousemove",o.dragFunction),o.touchmove=o.gridster.renderer.listen(o.gridster.el,"touchmove",o.dragFunction)})),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStopFunction),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStopFunction),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStopFunction),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStopFunction),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStopFunction),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=e.clientX,this.lastMouse.clientY=e.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=e.clientX+this.offsetLeft-this.left,this.diffRight=e.clientX+this.offsetLeft-this.right,this.diffTop=e.clientY+this.offsetTop-this.top,this.diffBottom=e.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new f(this.gridsterItem),this.pushResize=new O(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),(null===(i=e.target)||void 0===i?void 0:i.hasAttribute("class"))&&e.target.getAttribute("class").split(" ").indexOf("handle-n")>-1?(this.resizeEventScrollType.n=!0,this.directionFunction=this.handleN):(null===(s=e.target)||void 0===s?void 0:s.hasAttribute("class"))&&e.target.getAttribute("class").split(" ").indexOf("handle-w")>-1?this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.e=!0,this.directionFunction=this.handleE):(this.resizeEventScrollType.w=!0,this.directionFunction=this.handleW):(null===(r=e.target)||void 0===r?void 0:r.hasAttribute("class"))&&e.target.getAttribute("class").split(" ").indexOf("handle-s")>-1?(this.resizeEventScrollType.s=!0,this.directionFunction=this.handleS):e.target.hasAttribute("class")&&e.target.getAttribute("class").split(" ").indexOf("handle-e")>-1?this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.w=!0,this.directionFunction=this.handleW):(this.resizeEventScrollType.e=!0,this.directionFunction=this.handleE):e.target.hasAttribute("class")&&e.target.getAttribute("class").split(" ").indexOf("handle-nw")>-1?this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.n=!0,this.resizeEventScrollType.e=!0,this.directionFunction=this.handleNE):(this.resizeEventScrollType.n=!0,this.resizeEventScrollType.w=!0,this.directionFunction=this.handleNW):e.target.hasAttribute("class")&&e.target.getAttribute("class").split(" ").indexOf("handle-ne")>-1?this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.n=!0,this.resizeEventScrollType.w=!0,this.directionFunction=this.handleNW):(this.resizeEventScrollType.n=!0,this.resizeEventScrollType.e=!0,this.directionFunction=this.handleNE):e.target.hasAttribute("class")&&e.target.getAttribute("class").split(" ").indexOf("handle-sw")>-1?this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.s=!0,this.resizeEventScrollType.e=!0,this.directionFunction=this.handleSE):(this.resizeEventScrollType.s=!0,this.resizeEventScrollType.w=!0,this.directionFunction=this.handleSW):e.target.hasAttribute("class")&&e.target.getAttribute("class").split(" ").indexOf("handle-se")>-1&&(this.gridster.$options.dirType===t.DirTypes.RTL?(this.resizeEventScrollType.s=!0,this.resizeEventScrollType.w=!0,this.directionFunction=this.handleSW):(this.resizeEventScrollType.s=!0,this.resizeEventScrollType.e=!0,this.directionFunction=this.handleSE)))},e.prototype.dragMove=function(t){var e=this;t.stopPropagation(),t.preventDefault(),a.checkTouchEvent(t),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,T(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.directionFunction.bind(this),!0,this.resizeEventScrollType);var i=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(t.clientX-this.originalClientX)/i,clientY:this.originalClientY+(t.clientY-this.originalClientY)/i}),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run((function(){e.gridster.updateGrid()}))},e.prototype.dragStop=function(t){var e=this;t.stopPropagation(),t.preventDefault(),z(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeResize.bind(this),this.cancelResize.bind(this)):this.makeResize(),setTimeout((function(){e.gridsterItem.renderer.removeClass(e.gridsterItem.el,"gridster-item-resizing"),e.gridster&&(e.gridster.movingItem=null,e.gridster.previewStyle())}))},e.prototype.cancelResize=function(){this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),delete this.push,this.pushResize.destroy(),delete this.pushResize},e.prototype.makeResize=function(){this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),delete this.push,this.pushResize.destroy(),delete this.pushResize},e.prototype.handleN=function(t){if(this.top=t.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight,this.top=this.bottom-this.minHeight),this.newPosition=this.gridster.pixelsToPositionY(this.top+this.margin,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},e.prototype.handleW=function(t){if(this.left=t.clientX+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width&&(this.width=this.minWidth,this.left=this.right-this.minWidth),this.newPosition=this.gridster.pixelsToPositionX(this.left+this.margin,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},e.prototype.handleS=function(t){if(this.height=t.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.newPosition=this.gridster.pixelsToPositionY(this.bottom,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.rows=this.itemBackup[3],void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},e.prototype.handleE=function(t){if(this.width=t.clientX+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.newPosition=this.gridster.pixelsToPositionX(this.right,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.cols=this.itemBackup[2],void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},e.prototype.handleNW=function(t){this.handleN(t),this.handleW(t)},e.prototype.handleNE=function(t){this.handleN(t),this.handleE(t)},e.prototype.handleSW=function(t){this.handleS(t),this.handleW(t)},e.prototype.handleSE=function(t){this.handleS(t),this.handleE(t)},e.prototype.toggle=function(){this.resizeEnabled=this.gridsterItem.canBeResized()},e.prototype.dragStartDelay=function(t){var e=this;if(a.checkTouchEvent(t),this.gridster.$options.resizable.delayStart)var i=setTimeout((function(){e.dragStart(t),l()}),this.gridster.$options.resizable.delayStart),s=this.gridsterItem.renderer.listen("document","mouseup",l),r=this.gridsterItem.renderer.listen("document","mouseleave",l),o=this.gridsterItem.renderer.listen("window","blur",l),h=this.gridsterItem.renderer.listen("document","touchmove",(function(e){a.checkTouchEvent(e),(Math.abs(e.clientX-t.clientX)>9||Math.abs(e.clientY-t.clientY)>9)&&l()})),n=this.gridsterItem.renderer.listen("document","touchend",l),d=this.gridsterItem.renderer.listen("document","touchcancel",l);else this.dragStart(t);function l(){clearTimeout(i),o(),s(),r(),h(),n(),d()}},e.prototype.setItemTop=function(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,t)},e.prototype.setItemLeft=function(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,t,this.top)},e.prototype.setItemHeight=function(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",t+"px")},e.prototype.setItemWidth=function(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",t+"px")},e}();G.decorators=[{type:e.Injectable}],G.ctorParameters=function(){return[{type:y},{type:n},{type:e.NgZone}]};var H=function(){function t(t,e,i,s){this.renderer=i,this.zone=s,this.el=t.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=e,this.drag=new W(this,e,this.zone),this.resize=new G(this,e,this.zone)}return Object.defineProperty(t.prototype,"zIndex",{get:function(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.gridster.addItem(this)},t.prototype.ngOnChanges=function(t){t.item&&(this.updateOptions(),this.init||this.gridster.calculateLayoutDebounce())},t.prototype.updateOptions=function(){this.$item=a.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0})},t.prototype.ngOnDestroy=function(){this.gridster.removeItem(this),delete this.gridster,this.drag.destroy(),delete this.drag,this.resize.destroy(),delete this.resize},t.prototype.setSize=function(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()},t.prototype.updateItemSize=function(){var t=this.$item.y*this.gridster.curRowHeight,e=this.$item.x*this.gridster.curColWidth,i=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,s=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=t,this.left=e,!this.init&&i>0&&s>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),i===this.width&&s===this.height||(this.width=i,this.height=s,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this))},t.prototype.itemChanged=function(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this)},t.prototype.checkItemChanges=function(t,e){t.rows===e.rows&&t.cols===e.cols&&t.x===e.x&&t.y===e.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=e.x||0,this.$item.y=e.y||0,this.$item.cols=e.cols||1,this.$item.rows=e.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayoutDebounce(),this.itemChanged()))},t.prototype.canBeDragged=function(){return!this.gridster.mobile&&(void 0===this.$item.dragEnabled?this.gridster.$options.draggable.enabled:this.$item.dragEnabled)},t.prototype.canBeResized=function(){return!this.gridster.mobile&&(void 0===this.$item.resizeEnabled?this.gridster.$options.resizable.enabled:this.$item.resizeEnabled)},t.prototype.bringToFront=function(t){if(!(t&&t<=0)){var e=this.getLayerIndex(),i=this.gridster.$options.maxLayerIndex;if(e<i){var s=t?e+t:i;this.item.layerIndex=this.$item.layerIndex=s>i?i:s}}},t.prototype.sendToBack=function(t){if(!(t&&t<=0)){var e=this.getLayerIndex();if(e>0){var i=t?e-t:0;this.item.layerIndex=this.$item.layerIndex=i<0?0:i}}},t.prototype.getLayerIndex=function(){return void 0!==this.item.layerIndex?this.item.layerIndex:void 0!==this.gridster.$options.defaultLayerIndex?this.gridster.$options.defaultLayerIndex:0},t}();H.decorators=[{type:e.Component,args:[{selector:"gridster-item",template:'<ng-content></ng-content>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.s && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-s"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.e && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-e"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.n && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-n"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.w && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-w"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.se && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-se"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.ne && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-ne"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.sw && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-sw"></div>\n<div (mousedown)="resize.dragStartDelay($event)" (touchstart)="resize.dragStartDelay($event)"\n     *ngIf="gridster.$options.resizable.handles.nw && resize.resizeEnabled"\n     class="gridster-item-resizable-handler handle-nw"></div>\n',encapsulation:e.ViewEncapsulation.None,styles:["gridster-item{-ms-user-select:text;-webkit-user-select:text;background:#fff;box-sizing:border-box;display:none;overflow:hidden;position:absolute;transition:.3s;user-select:text;z-index:1}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-moving,gridster-item.gridster-item-resizing{box-shadow:0 0 5px 5px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);transition:0s;z-index:2}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;left:0;right:0;top:0}.gridster-item-resizable-handler.handle-e{bottom:0;cursor:ew-resize;right:0;top:0;width:10px}.gridster-item-resizable-handler.handle-s{bottom:0;cursor:ns-resize;height:10px;left:0;right:0}.gridster-item-resizable-handler.handle-w{bottom:0;cursor:ew-resize;left:0;top:0;width:10px}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;height:10px;right:0;top:0;width:10px}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;height:10px;left:0;top:0;width:10px}.gridster-item-resizable-handler.handle-se{border-color:rgba(0,0,0,0);border-style:solid;border-width:0 0 10px 10px;bottom:0;cursor:se-resize;height:0;right:0;width:0}.gridster-item-resizable-handler.handle-sw{bottom:0;cursor:sw-resize;height:10px;left:0;width:10px}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:rgba(0,0,0,0) rgba(0,0,0,0) #ccc}"]}]}],H.ctorParameters=function(){return[{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:g},{type:e.Renderer2,decorators:[{type:e.Inject,args:[e.Renderer2]}]},{type:e.NgZone,decorators:[{type:e.Inject,args:[e.NgZone]}]}]},H.propDecorators={item:[{type:e.Input}],zIndex:[{type:e.HostBinding,args:["style.z-index"]}]};var X=function(){function t(t,e,i){this.renderer=i,this.el=t.nativeElement,this.gridster=e,this.gridster.previewStyle=this.previewStyle.bind(this)}return t.prototype.ngOnDestroy=function(){delete this.el,delete this.gridster.previewStyle,delete this.gridster},t.prototype.previewStyle=function(t){this.gridster.movingItem?(this.gridster.compact&&t&&this.gridster.compact.checkCompactItem(this.gridster.movingItem),this.renderer.setStyle(this.el,"display","block"),this.gridster.gridRenderer.updateItem(this.el,this.gridster.movingItem,this.renderer)):this.renderer.setStyle(this.el,"display","")},t}();X.decorators=[{type:e.Component,args:[{selector:"gridster-preview",template:"",encapsulation:e.ViewEncapsulation.None,styles:["gridster-preview{background:rgba(0,0,0,.15);display:none;position:absolute}"]}]}],X.ctorParameters=function(){return[{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:g},{type:e.Renderer2,decorators:[{type:e.Inject,args:[e.Renderer2]}]}]};var Y=function(){};Y.decorators=[{type:e.NgModule,args:[{declarations:[g,H,X],imports:[i.CommonModule],exports:[g,H]}]}],t.GridsterComponent=g,t.GridsterComponentInterface=n,t.GridsterConfigService=l,t.GridsterItemComponent=H,t.GridsterItemComponentInterface=y,t.GridsterModule=Y,t.GridsterPush=f,t.GridsterPushResize=O,t.GridsterSwap=F,t.a=X,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-gridster2.umd.min.js.map